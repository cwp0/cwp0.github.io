---
title: 系统设计
tags:
  - 系统设计
  - 面经
categories:
  - 面经
keywords:
  - 面经
description: 系统设计
abbrlink: 17778
date: 2024-06-27 23:39:07
updated: 2024-06-28 00:15:15
top_img: https://s2.loli.net/2024/06/27/xFVKjeyNk45c8wv.png
comments:
cover: https://s2.loli.net/2024/06/27/OKRYQHdoCfGmgxr.png
toc:
toc_number:
toc_style_simple:
copyright:
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
mathjax:
katex:
aplayer:
highlight_shrink:
aside:
abcjs:
---

### 实现多个客户端访问一个服务端
使用`Socket`编程来实现一个简单的客户端-服务端模型。

服务端代码：
```python
import socket
import threading

# 定义服务端的IP地址和端口
server_ip = '127.0.0.1'
server_port = 12345

# 创建Socket对象
server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server_socket.bind((server_ip, server_port))
server_socket.listen(5)  # 最大连接数

print(f"服务器启动，监听端口: {server_port}")

def handle_client(client_socket):
    while True:
        try:
            message = client_socket.recv(1024).decode('utf-8')
            if not message:
                break
            print(f"收到消息: {message}")
            response = f"服务器收到消息: {message}"
            client_socket.send(response.encode('utf-8'))
        except ConnectionResetError:
            break
    client_socket.close()

while True:
    client_socket, client_address = server_socket.accept()
    print(f"连接来自: {client_address}")
    client_handler = threading.Thread(target=handle_client, args=(client_socket,))
    client_handler.start()
```
客户端代码：
```python
import socket

# 定义服务端的IP地址和端口
server_ip = '127.0.0.1'
server_port = 12345

# 创建Socket对象
client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client_socket.connect((server_ip, server_port))

while True:
    message = input("请输入发送给服务器的消息: ")
    if message.lower() == 'exit':
        break
    client_socket.send(message.encode('utf-8'))
    response = client_socket.recv(1024).decode('utf-8')
    print(f"服务器回应: {response}")

client_socket.close()
```
服务端代码:
- 创建一个`Socket`对象并绑定到指定的IP地址和端口。
- 使用`listen()`方法开始监听连接。
- 当有客户端连接时，接受连接并创建一个新的线程来处理该客户端的通信。
- `handle_client`函数负责处理与客户端的通信，包括接收消息和发送响应。

客户端代码:
- 创建一个`Socket`对象并连接到服务端的IP地址和端口。
- 进入一个循环，从用户输入获取消息并发送到服务端。
- 接收服务端的响应并打印出来。
- 当用户输入`'exit'`时，关闭连接。

这种方法使用多线程来处理多个客户端的连接，每个客户端都有一个单独的线程来处理，从而实现了多个客户端访问一个服务端。

